name = "alist-landing-worker"
main = "dist/worker.js"
compatibility_date = "2024-01-01"

[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = true

# Environment variables (configure in Cloudflare Dashboard or secrets)
# [vars]
# 控制面为唯一策略来源，wrangler 仅保留 infra 级 env：
# - ENV / ROLE / INSTANCE_ID / APP_NAME / APP_VERSION
# - CONTROLLER_URL / CONTROLLER_API_PREFIX / CONTROLLER_API_TOKEN
# - BOOTSTRAP_CACHE_MODE / METRICS_MODE（支持 direct/do/do+kv/d1；决策仅 direct）
# - BOOTSTRAP_DO / METRICS_DO / BOOTSTRAP_KV 绑定
# - CACHE_D1（D1 缓存绑定，可选）/ INIT_TABLES（是否在 Worker 内自动建表，默认 false）
# - INTERNAL_API_TOKEN（控制 API）
# - ENABLE_CF_RATELIMITER / CF_RATELIMITER_BINDING（可选）
# 验证链/crypt/限流/路径策略均由 controller.common / landing 下发，勿在 wrangler 配置策略 env。
#
# .dev.vars 示例：
# ENV=staging
# ROLE=landing
# INSTANCE_ID=landing-dev-1
# APP_NAME=alist-landing-worker
# APP_VERSION=dev
# CONTROLLER_URL=https://controller.example.com
# CONTROLLER_API_PREFIX=/api/v0
# CONTROLLER_API_TOKEN=replace-with-controller-token
# BOOTSTRAP_CACHE_MODE=d1
# METRICS_MODE=do
# CACHE_D1=CACHE_D1
# INIT_TABLES=false
# BOOTSTRAP_DO=BootstrapDO
# METRICS_DO=MetricsDO
# BOOTSTRAP_KV=BOOTSTRAP_KV
# INTERNAL_API_TOKEN=replace-with-internal-token
# ENABLE_CF_RATELIMITER=false
# CF_RATELIMITER_BINDING=CF_RATE_LIMITER
# 如需启用 CF 原生限流，请配置 [[rate_limit]] binding 名称与 CF_RATELIMITER_BINDING 一致。

# Optional: D1 cache binding example
# [[d1_databases]]
# binding = "CACHE_D1"
# database_name = "controller_cache"
# database_id = "replace-with-id"

# Optional: Cloudflare Rate Limiter binding example
# [[rate_limit]]
# binding = "CF_RATE_LIMITER"
# simple = { period = 10, limit = 20 }
